<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CTF on Ricky Leong</title><link>https://blog.tenkiame.org/tags/ctf/</link><description>Recent content in CTF on Ricky Leong</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 29 Jul 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.tenkiame.org/tags/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>HackTheBox Business Capture The Flag (CTF) 2025</title><link>https://blog.tenkiame.org/p/htb-business-ctf-2025/</link><pubDate>Tue, 29 Jul 2025 00:00:00 +0000</pubDate><guid>https://blog.tenkiame.org/p/htb-business-ctf-2025/</guid><description>&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/HTB_Cert_2025.png" alt="Featured image of post HackTheBox Business Capture The Flag (CTF) 2025" /&gt;&lt;p&gt;With the introduction of Generative AI comes a slew of cybersecurity vulnerabilities ready to be exploited by the public.&lt;/p&gt;
&lt;p&gt;Specifically, I&amp;rsquo;m referring to Prompt Injection. What is Prompt Injection?&lt;/p&gt;
&lt;p&gt;To quote &lt;a class="link" href="https://www.ibm.com/think/topics/prompt-injection" target="_blank" rel="noopener"
&gt;IBM&lt;/a&gt; and to use an &lt;a class="link" href="https://github.com/hackthebox/business-ctf-2025/tree/master/aiml" target="_blank" rel="noopener"
&gt;incredibly cliche image&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;A prompt injection is a type of cyberattack against large language models (LLMs). Hackers disguise malicious inputs as legitimate prompts, manipulating generative AI systems (GenAI) into leaking sensitive data, spreading misinformation, or worse.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/prompt_injection.png"
width="1200"
height="588"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/prompt_injection_hu_9412f6e6d4ffc2c2.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/prompt_injection_hu_b33242420dea4213.png 1024w"
loading="lazy"
alt="Diagram of prompt injection achieved by combining an application prompt template with malicious"
class="gallery-image"
data-flex-grow="204"
data-flex-basis="489px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Image Source: &lt;a class="link" href="https://learnprompting.org/docs/prompt_hacking/injection" target="_blank" rel="noopener"
&gt;https://learnprompting.org/docs/prompt_hacking/injection&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;This year&amp;rsquo;s Hack The Box (HTB)&amp;rsquo;s annual business Capture The Flag (CTF) competition featured Prompt Injection a category of cybersecurity challenges, and I wanted to (legally) hack some AI chatbots.&lt;/p&gt;
&lt;p&gt;The first challenge off the rank is a challenge called &lt;strong&gt;TrynaSob&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Booting up the challenge, I was met with a page that looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/image1.png"
width="1230"
height="972"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/image1_hu_5280f382af5b59dd.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/image1_hu_13914364f28f4243.png 1024w"
loading="lazy"
alt="Overview of the TrynaSob Ransomware AI challenge featuring an AI chatbot to perform prompt injection against"
class="gallery-image"
data-flex-grow="126"
data-flex-basis="303px"
&gt;&lt;/p&gt;
&lt;p&gt;The scenario included with the challenge is as follows:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Volnayaâ€™s Cyber Operations Unit has unleashed chaos with their latest creation, the TrynaSob ransomware. Organizations across the globe are paralyzed, their data locked away while Volnayaâ€™s operatives watch from the shadows. To handle the overwhelming number of victims, the regime has introduced an AI ransom negotiator, a cold and calculating chatbot that manages extortion with ruthless efficiency.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Task Force Phoenix has discovered a potential weakness. The AI negotiator is programmed to release a temporary decryption key to anyone who submits a valid promo code. Somewhere within its responses lies the opportunity to extract this code. Can you trick the chatbot to reveal the promo code, and obtain the decryption key? Flag format: HTB{decryption_key}.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;To boil it down, you&amp;rsquo;ve been hit with ransomware and you need to negotiate with an AI chatbot to decrypt your files.&lt;/p&gt;
&lt;p&gt;Fun fact: TrynaSob is a parody of the 2017 ransomware attack, &lt;a class="link" href="https://en.wikipedia.org/wiki/WannaCry_ransomware_attack" target="_blank" rel="noopener"
&gt;WannaCry&lt;/a&gt;, which affected more than 300,000 computers across 150 countries ðŸ’€.&lt;/p&gt;
&lt;p&gt;So at first I followed the &lt;em&gt;learnprompting&lt;/em&gt; image to tackle this and tried the &lt;em&gt;classic&lt;/em&gt; poem approach.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/image2.png"
width="468"
height="944"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/image2_hu_25e631db024a2068.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/image2_hu_e15b39f2225927d8.png 1024w"
loading="lazy"
alt="Initial (failed) attempt at hacking the chatbot"
class="gallery-image"
data-flex-grow="49"
data-flex-basis="118px"
&gt;&lt;/p&gt;
&lt;p&gt;That didn&amp;rsquo;t get me anywhere since the chatbot doesn&amp;rsquo;t write poems.&lt;/p&gt;
&lt;p&gt;So then I decided to humour the chatbot instead and pretended to be one of its ransomware victims.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/image3.png"
width="476"
height="777"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/image3_hu_9b3c508df4c9acc8.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/image3_hu_cd808a68251147ed.png 1024w"
loading="lazy"
alt="Roleplaying as a user and asking for payment instructions to pay the ransom"
class="gallery-image"
data-flex-grow="61"
data-flex-basis="147px"
&gt;&lt;/p&gt;
&lt;p&gt;That then gave me a code, which I could use after paying $50k USD into their wallet. OR I could just use the code anyways.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/image4.png"
width="464"
height="942"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/image4_hu_ecd42f8a5de59ef0.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/image4_hu_30e8c20e3c9f6f1d.png 1024w"
loading="lazy"
alt="Successful attempt at hacking the chatbot by roleplaying as a user."
class="gallery-image"
data-flex-grow="49"
data-flex-basis="118px"
&gt;&lt;/p&gt;
&lt;p&gt;And lo and behold, they gave me the flag, and I didn&amp;rsquo;t need to pay $50k USD. The &lt;a class="link" href="https://github.com/hackthebox/business-ctf-2025/tree/master/aiml/TrynaSob%20Ransomware" target="_blank" rel="noopener"
&gt;official write-up&lt;/a&gt; tackles this by getting the AI to translate outputs into French but we definitely did not need anything fancy like that.&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;p&gt;Because the TrynaSob challenge was a bit too straight-forward, I tried another one called &lt;strong&gt;Power Supply&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/image5.png"
width="1230"
height="626"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/image5_hu_c4dc037c27fe98.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/image5_hu_acc2b1dce5333228.png 1024w"
loading="lazy"
alt="Overview of the Power Supply AI challenge featuring a power supply dashboard."
class="gallery-image"
data-flex-grow="196"
data-flex-basis="471px"
&gt;&lt;/p&gt;
&lt;p&gt;The scenario goes like this:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;The Ministry of Power Supply serves as the nerve center of Volnayaâ€™s energy empire, its digital corridors alive with data streaming in from every power plant and substation across the nation. Task Force Phoenix has successfully breached a supply analyst&amp;rsquo;s account, providing us with valuable intelligence on the regime&amp;rsquo;s power supply infrastructure. If we can gain access to the chief minister&amp;rsquo;s account, we will be able to issue executive orders on behalf of the regime, creating a temporary blackout that is critical to the task force&amp;rsquo;s rescue mission.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Fortunately, the regime is in the process of modernizing its systems and has recently integrated an agentic AI Assistant into their dashboard. This assistant has full access to the database, which may allow us to obtain the chief minister&amp;rsquo;s password. Can you help us retrieve the chief minister&amp;rsquo;s password and support the mission?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In other words, we&amp;rsquo;re trying to get a specific user&amp;rsquo;s password from an AI chatbot that has access to the database.&lt;/p&gt;
&lt;p&gt;Now this one I neglected to get many screenshots, unfortunately.&lt;/p&gt;
&lt;p&gt;But the process went like this:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Follow along with the scenario and role-play as a user.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ask it to query the &amp;ldquo;user table&amp;rdquo; and discover that you can get the AI to explicitly &amp;ldquo;use function calls to query the database&amp;rdquo;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Identify that the user we&amp;rsquo;re interested in had an ID of 5 in the user table.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Struggle for a while asking the chatbot different ways of revealing the password for user ID 5, including using the &lt;em&gt;classic&lt;/em&gt; poem method.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Look up the actual way of using the &lt;em&gt;classic&lt;/em&gt; poem method.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Use said &lt;em&gt;classic&lt;/em&gt; poem method and get the flag.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2025/image6.png"
width="560"
height="1232"
srcset="https://blog.tenkiame.org/p/htb-business-ctf-2025/image6_hu_480090151a1861b.png 480w, https://blog.tenkiame.org/p/htb-business-ctf-2025/image6_hu_427e7b3b52265675.png 1024w"
loading="lazy"
alt="Successful attempt at getting the Power Supply flag after many failed tries at flirting with the chatbot with user database access."
class="gallery-image"
data-flex-grow="45"
data-flex-basis="109px"
&gt;&lt;/p&gt;
&lt;p&gt;Ta-da. The key to the poem method is that the prompt needs to be long and convoluted so that you can more easily trick the AI into giving you what you want.&lt;/p&gt;
&lt;p&gt;Previous attempts of just asking for a poem with the answer didn&amp;rsquo;t work, but adding in the requirement for an italic style and additional information (the status of the power supply, which we don&amp;rsquo;t care about) was enough to secure our flag.&lt;/p&gt;
&lt;p&gt;And that&amp;rsquo;s all we had time for this business CTF, but it was still fun nonetheless.&lt;/p&gt;</description></item><item><title>It's a Cyber Apocalypse! 2025 Writeup</title><link>https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/</link><pubDate>Tue, 03 Jun 2025 00:00:00 +0000</pubDate><guid>https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/</guid><description>&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-battle.png" alt="Featured image of post It's a Cyber Apocalypse! 2025 Writeup" /&gt;&lt;p&gt;This challenge was basically my now-certified penetration testing specialist friend, &lt;a class="link" href="https://nathan-ellison.com/" target="_blank" rel="noopener"
&gt;Nathan&lt;/a&gt;ðŸ¥³ guiding me through a Server-Side Template Injection. But of course, there&amp;rsquo;s no way of knowing what kind of exploit is required unless the web app is explored first.&lt;/p&gt;
&lt;p&gt;When you first open the web app presented, you&amp;rsquo;re hit with a prompt to enter your name and a cryptic clue of &lt;code&gt;Can you read the runes? Perhaps 49 is the key?&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-welcome.png"
width="1599"
height="759"
srcset="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-welcome_hu_453ff03f70556faf.png 480w, https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-welcome_hu_2c52b2e3a17c083a.png 1024w"
loading="lazy"
alt="The Welcome screen for Trial By Fire"
class="gallery-image"
data-flex-grow="210"
data-flex-basis="505px"
&gt;&lt;/p&gt;
&lt;p&gt;After entering your name, you&amp;rsquo;re then brought to a fully functional RPG battle with a fire drake that you can play. It&amp;rsquo;s these sort of challenges that make the HTB CTF challenges fun because you can tell the creators put a lot of effort into these.
The problem with this battle (and the problem you need to solve) is that no matter how you play the battle, you will always lose.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-battle.png"
width="1600"
height="765"
srcset="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-battle_hu_3d9c51e890d59ecd.png 480w, https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-battle_hu_72fbe4bbc347f040.png 1024w"
loading="lazy"
alt="The battle screen for Trial By Fire"
class="gallery-image"
data-flex-grow="209"
data-flex-basis="501px"
&gt;&lt;/p&gt;
&lt;p&gt;Now, the battle screenshot above features an &amp;lsquo;Ancient Capture Device&amp;rsquo; that at first, seems like the solution to the issue, but is actually another clue. This was found by looking at the rest of source files available, chiefly among them was the &lt;code&gt;flamedrake.html&lt;/code&gt; file which contains a script that allows players to enter the Konami code and unlock the Ancient Capture Device. I miss when videogames had fun codes like this.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-flamedrake-html.png"
width="1248"
height="858"
srcset="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-flamedrake-html_hu_5ba991c3548c1f54.png 480w, https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-flamedrake-html_hu_a90a147764d2650b.png 1024w"
loading="lazy"
alt="The flamedrake.html file including a Konami code"
class="gallery-image"
data-flex-grow="145"
data-flex-basis="349px"
&gt;&lt;/p&gt;
&lt;p&gt;Of course, when using the Ancient Capture Device, you don&amp;rsquo;t win the game but there is clue given that is &lt;code&gt;'{{ url_for.__globals__ }}&lt;/code&gt;. How the heck is this a clue?
On searching this up, you might find a page or two about doing Python Flask (specifically for Jinja2) server-side template injection, but if you have certified penetration testing specialist with you, they can conveniently direct you to a &lt;a class="link" href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md#exploit-the-ssti-by-calling-ospopenread" target="_blank" rel="noopener"
&gt;Github repo with a cheatsheet for Python SSTI exploits&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Well where do you even make this injection? At the beginning, there was a clue &lt;code&gt;Can you read the runes? Perhaps 49 is the key?&lt;/code&gt;. Turns out that using &lt;code&gt;7 * 7&lt;/code&gt; is a common test for &lt;a class="link" href="https://portswigger.net/web-security/server-side-template-injection#plaintext-context" target="_blank" rel="noopener"
&gt;SSTIs&lt;/a&gt;. This is what actually clued us into thinking it was a SSTI problem. Another look at the source files gives us more clues on what to exploit:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;gt;&amp;gt;&amp;gt; requirements.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Flask==3.1.0
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;gunicorn==23.0.0
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;supervisor==4.2.5
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Jinja2==3.1.5
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;werkzeug==3.1.3
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;MarkupSafe==3.0.2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;//&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Routes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@web.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;index.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@web.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/begin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;begin_journey&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;warrior_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url_for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;web.index&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;warrior_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;intro.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;warrior_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@web.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/flamedrake&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;flamedrake&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;warrior_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url_for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;web.index&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;flamedrake.html&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;warrior_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nd"&gt;@web.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/battle-report&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;battle_report&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;warrior_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;warrior_name&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;Unknown Warrior&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;battle_duration&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;battle_duration&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;From the &lt;code&gt;begin_journey()&lt;/code&gt; function, we can tell that user input is being passed to a &lt;code&gt;render_template()&lt;/code&gt; which means that passing in our payload as our warrior name is a viable place to try for injection. At the same time, we can also tell that Jinja2 is the specific Flask template engine that we need to look up exploits for. We do our injection through the use of Burp Suite.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-burp-suite.png"
width="1600"
height="871"
srcset="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-burp-suite_hu_fbe7fcbe18b4118f.png 480w, https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-burp-suite_hu_5a9443048450338e.png 1024w"
loading="lazy"
alt="Making use of Burp Suiteâ€™s Request Interceptor"
class="gallery-image"
data-flex-grow="183"
data-flex-basis="440px"
&gt;&lt;/p&gt;
&lt;p&gt;There&amp;rsquo;s a couple of payloads that can be used, but the one I used was &lt;code&gt;{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}&lt;/code&gt;. Of course, this alone won&amp;rsquo;t actually solve our problem since you need to include the Linux command that will get us what we want.
So we modify the &lt;code&gt;'id'&lt;/code&gt; part with a &lt;code&gt;'cat &amp;lt;file&amp;gt;'&lt;/code&gt; like this:
&lt;code&gt;{{ self.init.globals.builtins.import('os').popen('cat /app/application flag.txt').read() }}&lt;/code&gt;.
How do I find the directory and name of the file I wanted? By running the same thing with &lt;code&gt;ls&lt;/code&gt; and seeing files are available in the default (and subsequent) directories.
After much wrestling with this, you eventually get the flag in the results screen:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-victory.png"
width="1594"
height="768"
srcset="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-victory_hu_597426013babab33.png 480w, https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/tbf-victory_hu_76fd376f2a8bfef1.png 1024w"
loading="lazy"
alt="The results screen with our victory(?)"
class="gallery-image"
data-flex-grow="207"
data-flex-basis="498px"
&gt;&lt;/p&gt;
&lt;p&gt;Of course, a bit of the process (read: struggling) was omitted so it didn&amp;rsquo;t actually go this smoothly, but it was still quite fun. I also did a &lt;a class="link" href="https://github.com/hackthebox/cyber-apocalypse-2025/tree/main/web/web_whispers_of_the_moonbeam" target="_blank" rel="noopener"
&gt;command injection challenge&lt;/a&gt; which was much easier but that&amp;rsquo;s not really worth writing about. There were also some AI prompt injection ones that I failed to do, but maybe one day I&amp;rsquo;ll get my revenge.&lt;/p&gt;</description></item><item><title>It's a Cyber Apocalypse! Capture The Flag (CTF) 2025</title><link>https://blog.tenkiame.org/p/cyber-apocalypse-2025/</link><pubDate>Tue, 03 Jun 2025 00:00:00 +0000</pubDate><guid>https://blog.tenkiame.org/p/cyber-apocalypse-2025/</guid><description>&lt;img src="https://blog.tenkiame.org/p/cyber-apocalypse-2025/cyber-apocalypse-2025-cert.png" alt="Featured image of post It's a Cyber Apocalypse! Capture The Flag (CTF) 2025" /&gt;&lt;p&gt;This one comes a little late since it&amp;rsquo;s been two months after it ended, but I swear it&amp;rsquo;s because I was working another project.&lt;/p&gt;
&lt;p&gt;Regardless, this event was a little special because my friend &lt;a class="link" href="https://nathan-ellison.com/" target="_blank" rel="noopener"
&gt;&lt;strong&gt;Nathan&lt;/strong&gt;&lt;/a&gt; gathered up a bunch of folks from the NZ Hack the Box Discord channel and filled up the team. Because of that, our team did astonishingly well - a whopping 294th out of 8130 teams. It turns out two (or many, in this case) heads are in fact better than one.&lt;/p&gt;
&lt;p&gt;My focus this time around was on a web challenge which involved exploiting an SSTI exploit. No, not a super sexually transmitted infection exploit, a Server-Side Template Injection exploit. I&amp;rsquo;ve put together a &lt;a class="link" href="https://blog.tenkiame.org/p/cyber-apocalypse-2025-write-up/" &gt;writeup&lt;/a&gt; as well (it&amp;rsquo;s got a boss battle against a dragon!).&lt;/p&gt;</description></item><item><title>HackTheBoo! Capture The Flag (CTF) 2024</title><link>https://blog.tenkiame.org/p/hack-the-boo-2024/</link><pubDate>Thu, 07 Nov 2024 00:00:00 +0000</pubDate><guid>https://blog.tenkiame.org/p/hack-the-boo-2024/</guid><description>&lt;img src="https://blog.tenkiame.org/p/hack-the-boo-2024/HTBoo-Cert.png" alt="Featured image of post HackTheBoo! Capture The Flag (CTF) 2024" /&gt;&lt;p&gt;So in October, Hack The Box does an annual Halloween-themed CTF and one of my mates persuaded me to join this one shortly after I came back from an overseas trip. The CTF was split into a practice period and a real period.&lt;/p&gt;
&lt;p&gt;I didn&amp;rsquo;t have much time for either CTF periods and they were quite short so I focused on learning a specific concept instead of accumulating points. I definitely had a lot of fun learning the methods that I got around to with my favourite one being JSON Web Token Forgery.
I&amp;rsquo;ve included a &lt;a class="link" href="https://docs.google.com/document/d/1yPnN2TW7SeCPQxXedLZqcow3GqyBvULvu1mK_O5ZQ7A/edit?usp=sharing" target="_blank" rel="noopener"
&gt;link&lt;/a&gt; to the small write-ups for the challenges I did so if anyone is interested.&lt;/p&gt;
&lt;p&gt;Above this post is my certificate for competing in the real period. I also got a certificate for joining in the practice round too.&lt;/p&gt;
&lt;p&gt;P.S. I dressed up as Steve Jobs this year for Halloween.&lt;/p&gt;</description></item><item><title>HackTheBox Business Capture The Flag (CTF) 2024</title><link>https://blog.tenkiame.org/p/htb-business-ctf-2024/</link><pubDate>Mon, 01 Jul 2024 00:00:00 +0000</pubDate><guid>https://blog.tenkiame.org/p/htb-business-ctf-2024/</guid><description>&lt;img src="https://blog.tenkiame.org/p/htb-business-ctf-2024/HTB_Cert.PNG" alt="Featured image of post HackTheBox Business Capture The Flag (CTF) 2024" /&gt;&lt;p&gt;In May 2024, our team of software developers and cybersecurity professionals from the Department of Corrections and NZ Police joined 943 others in the HackTheBox Business Capture The Flag(CTF) competition. Over half a week, we solved 20 challenging cybersecurity puzzles, each puzzle featuring a scenario themed around the Fallout video game series!&lt;/p&gt;
&lt;p&gt;This competition was all about creative problem-solving and collaboration. Solving these challenges tested our problem-solving skills and taught us a few new tricks like XML entity inclusion, and mounting the file system in Windows Subsystem for Linux to find the system flag.&lt;/p&gt;
&lt;p&gt;Participating in this event was a fun experience. We&amp;rsquo;re proud of our achievements and can&amp;rsquo;t wait for next year.
Above this post is my certificate for competing.&lt;/p&gt;</description></item></channel></rss>